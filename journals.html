<!DOCTYPE html>
<html lang="ru" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <title>–ñ—É—Ä–Ω–∞–ª—ã –ø–æ –æ–±—ä–µ–∫—Ç–∞–º</title>
  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>

  <!-- Tabulator CSS -->
  <link href="https://unpkg.com/tabulator-tables@5.5.0/dist/css/tabulator.min.css" rel="stylesheet">

  <!-- Custom Styles -->
  <link rel="stylesheet" href="styles.css">
</head>
  
<body>
<div class="app-container">
  <!-- Sidebar -->
  <aside class="sidebar">
    <h2>Intellectual Journal</h2>
<ul>
  <li>
    <a href="dashboard.html" style="color: white; text-decoration: none;">
      <i class="fas fa-tachometer-alt"></i> –î–∞—à–±–æ—Ä–¥
    </a>
  </li>
  <li>
    <a href="index.html" style="color: white; text-decoration: none;">
      <i class="fas fa-building"></i> –û–±—ä–µ–∫—Ç—ã
    </a>
  </li>
  <li>
    <a href="photos.html" style="color: white; text-decoration: none;">
      <i class="fas fa-camera"></i> –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
    </a>
  </li>
  <li class="active">
    <a href="journals.html" style="color: white; text-decoration: none;">
      <i class="fas fa-book"></i> –ñ—É—Ä–Ω–∞–ª—ã
    </a>
  </li>
</ul>


  </aside>
  
  
 <!-- Main Content -->
  <main class="main-content">
 <div class="header">
  <h1>–ñ—É—Ä–Ω–∞–ª—ã</h1>
  <div style="display: flex; align-items: center; gap: 10px; margin-left: auto;">
    <button id="themeToggle" class="theme-toggle" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">üåó</button>
  </div>
</div>

   <div class="tabs" style="justify-content: space-between; align-items: center;">
  <div style="display: flex; gap: 8px;">
    <button class="tab-btn active" data-tab="tab-objects">
      <i class="fas fa-folder"></i> –†–µ–µ—Å—Ç—Ä –æ–±—ä–µ–∫—Ç–æ–≤
    </button>
    <button class="tab-btn" data-tab="tab-documents">
      <i class="fas fa-paperclip"></i> –†–µ–µ—Å—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
    </button>
  </div>

  <button id="exportExcelBtn" class="export-btn" title="–°–∫–∞—á–∞—Ç—å Excel">
    <i class="fas fa-file-excel"></i> –í—ã–≥—Ä—É–∑–∏—Ç—å –≤ Excel
  </button>
</div>


<div id="tab-objects" class="tab-section active">
      <div class="filters top-bar">
        <input type="text" id="filter-name" placeholder="–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞">
        <input type="text" id="filter-district" placeholder="–û–∫—Ä—É–≥">
        <input type="text" id="filter-performer" placeholder="–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å">
        <input type="text" id="filter-year" placeholder="–ì–æ–¥">
        <input type="text" id="filter-responsible" placeholder="–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π">
        <input type="text" id="filter-start" placeholder="–ù–∞—á–∞–ª–æ">
        <input type="text" id="filter-end" placeholder="–û–∫–æ–Ω—á–∞–Ω–∏–µ">

      </div>
      <div id="table-objects"></div>
    </div>

  <!-- Tab: –î–æ–∫—É–º–µ–Ω—Ç—ã -->
   <div id="tab-documents" class="tab-section">
  <div class="filters top-bar">
    <input type="text" id="filter-doc-name" placeholder="–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞">
      <input type="text" id="filter-doc-contract" placeholder="–ù–æ–º–µ—Ä –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞">
    <input type="text" id="filter-doc-number" placeholder="–ù–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞">
    <input type="text" id="filter-doc-date" placeholder="–î–∞—Ç–∞">
  </div>
  <div id="table-documents"></div>
</div>
  </main>
</div>

<script src="https://unpkg.com/tabulator-tables@5.5.0/dist/js/tabulator.min.js"></script>
<script>
  const objectData =[
    {
        "id": 1,
        "name": "–î–≤–æ—Ä–æ–≤–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è –ø–æ –∞–¥—Ä–µ—Å—É: –ü—É—Ç–µ–≤–æ–π –ø—Ä. 38",
        "year": 2024,
        "district": "–°–í–ê–û",
        "performer": "–ê–î",
        "responsible": "–ê–Ω–¥—Ä–µ–µ–≤ –Æ.–ê",
        "startDate": "15.04.2024",
        "endDate": "25.08.2024",
        "progress": "100",
        "_children": [
            {
                "name": "–†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∑–¥–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
                "startDate": "15.04.2024",
                "endDate": "25.04.2024",
                "progress": "100"
            },
            {
                "name": "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∑–¥–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
               
                "startDate": "25.04.2024",
                "endDate": "11.05.2024",
                "progress": "100"
            },
            {
                "name": "–†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ —Ç—Ä–æ—Ç—É–∞—Ä–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
      
                "startDate": "11.05.2024",
                "endDate": "28.05.2024",
                "progress": "100"
            },
            {
                "name": "–ó–∞–º–µ–Ω–∞ –¥–æ—Ä–æ–∂–Ω–æ–≥–æ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
             
                "startDate": "28.05.2024",
                "endDate": "15.06.2024",
                "progress": "100"
            },
            {
                "name": "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–æ—Ä–æ–∂–Ω–æ–≥–æ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
            
                "startDate": "15.06.2024",
                "endDate": "22.07.2024",
                "progress": "100"
            },
            {
                "name": "–†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ –∞–≤—Ç–æ–ø–∞—Ä–∫–æ–≤–∫–∏ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
             
                "startDate": "22.07.2024",
                "endDate": "25.08.2024",
                "progress": "100"
            },
        ]
    },
{
  id: 2,
  name: "–î–≤–æ—Ä–æ–≤–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è –ø–æ –∞–¥—Ä–µ—Å—É: –§–ª–æ—Ç—Å–∫–∞—è —É–ª. 54, 58 –∫.1",
  status: "–ó–∞–≤–µ—Ä—à–µ–Ω",
  year: 2024,
  district: "–°–ê–û",
  performer: "–ê–î",
  responsible: "–°–µ–º–µ–Ω–æ–≤ –ò.–ü",
  startDate: "15.04.2024",
  endDate: "15.08.2024",
  progress: "100",
  _children: [
    {
      name: "–†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∑–¥–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",

      startDate: "15.04.2024",
      endDate: "21.05.2024",
      progress: "100"
    },
    {
     
      startDate: "21.05.2024",
      endDate: "05.06.2024",
      progress: "100"
    },
    {
      name: "–†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ —Ç—Ä–æ—Ç—É–∞—Ä–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
     
      startDate: "05.06.2024",
      endDate: "25.06.2024",
      progress: "100"
    },
    {
      name: "–ó–∞–º–µ–Ω–∞ –¥–æ—Ä–æ–∂–Ω–æ–≥–æ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
      
      startDate: "25.06.2024",
      endDate: "12.07.2024",
      progress: "100"
    },
    {
      name: "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–æ—Ä–æ–∂–Ω–æ–≥–æ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
      
      startDate: "12.07.2024",
      endDate: "25.08.2024",
      progress: "100"
    }
  ]
},
{
  id: 3,
  name: "–î–≤–æ—Ä–æ–≤–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è –ø–æ –∞–¥—Ä–µ—Å—É: –ö–∞—Ä–≥–æ–ø–æ–ª—å—Å–∫–∞—è —É–ª. 18",
  status: "–ó–∞–≤–µ—Ä—à–µ–Ω",
  year: 2024,
  district: "–°–í–ê–û",
  performer: "–ê–î",
  responsible: "–ü–µ—Ç—Ä–æ–≤ –î.–°.",
  startDate: "15.04.2024",
  endDate: "25.08.2024",
  progress: "100",
  _children: [
    {
      name: "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å–∞–¥–æ–≤–æ–≥–æ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
      
      startDate: "15.04.2024",
      endDate: "24.05.2024",
      progress: "100"
    },
    {
      name: "–ó–∞–º–µ–Ω–∞ —Å–∞–¥–æ–≤–æ–≥–æ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
     
      startDate: "07.05.2024",
      endDate: "24.05.2024",
      progress: "100"
    },
    {
      name: "–†–µ–º–æ–Ω—Ç –≥–∞–∑–æ–Ω–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
     
      startDate: "24.05.2024",
      endDate: "30.05.2024",
      progress: "100"
    },
    {
      name: "–ó–∞–º–µ–Ω–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –∏–∑ —Ä–µ–∑–∏–Ω–æ–≤–æ–π –∫—Ä–æ—à–∫–∏ —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–∏ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
     
      startDate: "30.05.2024",
      endDate: "16.06.2024",
      progress: "100"
    },
    {
      name: "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ –ø–µ—à–µ—Ö–æ–¥–Ω–æ–π –¥–æ—Ä–æ–∂–∫–∏ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
      
      startDate: "16.06.2024",
      endDate: "29.06.2024",
      progress: "100"
    },
    {
      name: "–ó–∞–º–µ–Ω–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –∏–∑ —Ä–µ–∑–∏–Ω–æ–≤–æ–π –∫—Ä–æ—à–∫–∏ –¥–µ—Ç—Å–∫–æ–π –ø–ª–æ—â–∞–¥–∫–∏ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
      
      startDate: "29.06.2024",
      endDate: "26.07.2024",
      progress: "100"
    },
    {
      name: "–ó–∞–º–µ–Ω–∞ –æ–≥—Ä–∞–∂–¥–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–∏ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
      
      startDate: "26.07.2024",
      endDate: "25.08.2024",
      progress: "100"
    }
  ]
},
    {
  id: 4,
  name: "–î–≤–æ—Ä–æ–≤–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è –ø–æ –∞–¥—Ä–µ—Å—É: –ë–µ—Å—Ç—É–∂–µ–≤—ã—Ö —É–ª. 27–ê",
  status: "–ó–∞–≤–µ—Ä—à–µ–Ω",
  year: 2024,
  district: "–°–í–ê–û",
  performer: "–ê–î",
  responsible: "–ò–≤–∞–Ω–æ–≤–∞ –ù.–ê.",
  startDate: "15.04.2024",
  endDate: "25.08.2024",
  progress: "100",
  _children: [
    {
      name: "–†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∑–¥–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
     
      startDate: "15.04.2024",
      endDate: "21.05.2024",
      progress: "100"
    },
    {
      name: "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∑–¥–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
    
      startDate: "21.05.2024",
      endDate: "05.06.2024",
      progress: "100"
    },
    {
      name: "–†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ —Ç—Ä–æ—Ç—É–∞—Ä–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
      
      startDate: "05.06.2024",
      endDate: "25.06.2024",
      progress: "100"
    },
    {
      name: "–ó–∞–º–µ–Ω–∞ –¥–æ—Ä–æ–∂–Ω–æ–≥–æ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
     
      startDate: "25.06.2024",
      endDate: "12.07.2024",
      progress: "100"
    },
    {
      name: "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–æ—Ä–æ–∂–Ω–æ–≥–æ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
     
      startDate: "12.07.2024",
      endDate: "25.08.2024",
      progress: "100"
    }
  ]
},
{
  id: 5,
  name: "–î–≤–æ—Ä–æ–≤–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è –ø–æ –∞–¥—Ä–µ—Å—É: –ß–µ–ª–æ–±–∏—Ç—å–µ–≤—Å–∫–æ–µ —à–æ—Å—Å–µ 14 –∫.3, 14 –∫.4, 14 –∫.5",
  status: "–ó–∞–≤–µ—Ä—à–µ–Ω",
  year: 2024,
  district: "–°–í–ê–û",
  performer: "–ê–î",
  responsible: "–ö—É–∑–Ω–µ—Ü–æ–≤ –ê.–í.",
  startDate: "15.04.2024",
  endDate: "20.08.2024",
  progress: "100",
  _children: [
    {
      name: "–ó–∞–º–µ–Ω–∞ –æ–≥—Ä–∞–∂–¥–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–∏ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
      
      startDate: "15.04.2024",
      endDate: "23.04.2024",
      progress: "100"
    },
    {
      name: "–û–ë–£–°–¢–†–û–ô–°–¢–í–û –ú–ê–§ –¢–ï–†–†–ò–¢–û–†–ò–ô",
    
      startDate: "23.04.2024",
      endDate: "05.06.2024",
      progress: "100"
    },
    {
      name: "–ó–∞–º–µ–Ω–∞ –¥–æ—Ä–æ–∂–Ω–æ–≥–æ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
     
      startDate: "05.06.2024",
      endDate: "21.06.2024",
      progress: "100"
    },
    {
      name: "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ –ø–µ—à–µ—Ö–æ–¥–Ω–æ–π –¥–æ—Ä–æ–∂–∫–∏ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
    
      startDate: "21.06.2024",
      endDate: "20.08.2024",
      progress: "100"
    }
  ]
},
{
  id: 6,
  name: "–î–≤–æ—Ä–æ–≤–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è –ø–æ –∞–¥—Ä–µ—Å—É: –ú–∏—Ä–∞ –ø—Ä–æ—Å–ø. 194",
  status: "–ó–∞–≤–µ—Ä—à–µ–Ω",
  year: 2024,
  district: "–°–í–ê–û",
  performer: "–ê–î",
  responsible: "–§—ë–¥–æ—Ä–æ–≤ –ú.–ì.",
  startDate: "15.04.2024",
  endDate: "20.08.2024",
  progress: "100",
  _children: [
    {
      name: "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å–∞–¥–æ–≤–æ–≥–æ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
     
      startDate: "15.04.2024",
      endDate: "21.04.2024",
      progress: "100"
    },
    {
      name: "–†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ –∞–≤—Ç–æ–ø–∞—Ä–∫–æ–≤–∫–∏ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
     
      startDate: "21.04.2024",
      endDate: "03.06.2024",
      progress: "100"
    },
    {
      name: "–†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ —Ç—Ä–æ—Ç—É–∞—Ä–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
      
      startDate: "03.06.2024",
      endDate: "18.06.2024",
      progress: "100"
    },
    {
      name: "–†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∑–¥–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
     
      startDate: "18.06.2024",
      endDate: "17.07.2024",
      progress: "100"
    },
    {
      name: "–ó–∞–º–µ–Ω–∞ –¥–æ—Ä–æ–∂–Ω–æ–≥–æ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
     
      startDate: "17.07.2024",
      endDate: "20.08.2024",
      progress: "100"
    }
  ]
}
]
;

  const documentsData = [
    {
      name: "üìÑ –†–µ–µ—Å—Ç—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∫ –∞–∫—Ç—É",
      objectId: "1004466",
      docType: "–†–µ–µ—Å—Ç—Ä",
      docNumber: "–±/–Ω",
      uploadDate: "22.09.2024",
      pageCount: 2,
      sheetNum: 566
    },
    {
      name: "üìÑ –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∫–∞—á–µ—Å—Ç–≤–∞ (–≥–∞–∑–æ–Ω)",
      objectId: "1004466",
      docType: "–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç",
      docNumber: "829413–ì–¢",
      uploadDate: "03.10.2019",
      pageCount: 2,
      sheetNum: 568
    }
  ];
  


  const tableObjects = new Tabulator("#table-objects", {
    data: objectData,
    layout: "fitColumns",
    placeholder: "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
    height: 655,
    dataTree: true,
    dataTreeChildField: "_children",
    dataTreeStartExpanded: false,
 dataTreeCollapseElement: "<span style='margin-right: 3px; color: #888;'>‚ñº</span>",
  dataTreeExpandElement: "<span style='margin-right: 3px; color: #888;'>‚ñ∂</span>",

    columns: [
      { title: "–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ", field: "name", widthGrow: 2 },
      { title: "–ì–æ–¥", field: "year" },
      { title: "–û–∫—Ä—É–≥", field: "district" },
      { title: "–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å", field: "performer" },
      { title: "–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π", field: "responsible" },
      { title: "–ù–∞—á–∞–ª–æ", field: "startDate" },
      { title: "–û–∫–æ–Ω—á–∞–Ω–∏–µ", field: "endDate" },
      { title: "% –ó–∞–≤–µ—Ä—à–µ–Ω–∏—è", field: "progress" }
    ]
  });

const objectsWithDocuments = [
  {
    name: "–î–≤–æ—Ä–æ–≤–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è –ø–æ –∞–¥—Ä–µ—Å—É: –ü—É—Ç–µ–≤–æ–π –ø—Ä. 38",
    documents: [
      {
        name: "–ê–û–°–† –Ω–∞ –î–µ–º–æ–Ω—Ç–∞–∂ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è",
        workType: "–†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∑–¥–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
          contractNumber: "–û–£3/–û–¢1",
        number: "3.1/18/1",
        date: "31.05.2024",
        pages: 1
      },
      {
        name: "–ê–û–°–† –Ω–∞ –°—Ä–µ–∑–∫—É —Å–ª–æ—è –ê–ë –ø–æ–∫—Ä—ã—Ç–∏—è –º–µ—Ç–æ–¥–æ–º —Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Ñ—Ä–µ–∑–µ—Ä–æ–≤–∞–Ω–∏—è",
           workType: "–†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ —Ç—Ä–æ—Ç—É–∞—Ä–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
          contractNumber: "‚Ññ –≠–ú-39/18-–£",
        number: "1.1/18/1",
        date: "31.05.2024",
        pages: 1
      },
      {
        name: "–ê–û–°–† –Ω–∞ –°—Ä–µ–∑–∫—É —Å–ª–æ—è –ê–ë –ø–æ–∫—Ä—ã—Ç–∏—è –º–µ—Ç–æ–¥–æ–º —Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Ñ—Ä–µ–∑–µ—Ä–æ–≤–∞–Ω–∏—è",
           workType: "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–æ—Ä–æ–∂–Ω–æ–≥–æ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
          contractNumber: "15801-–£–†-19 3/6450-19",
        number: "2.1/18/1",
        date: "31.05.2024",
        pages: 1
      }
    ]
  },
  {
    name: "–î–≤–æ—Ä–æ–≤–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è –ø–æ –∞–¥—Ä–µ—Å—É: –§–ª–æ—Ç—Å–∫–∞—è —É–ª. 54, 58 –∫.1",
    documents: [
      {
        name: "–ê–û–°–† –Ω–∞ –°—Ä–µ–∑–∫—É —Å–ª–æ—è –ê–ë –ø–æ–∫—Ä—ã—Ç–∏—è –º–µ—Ç–æ–¥–æ–º —Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Ñ—Ä–µ–∑–µ—Ä–æ–≤–∞–Ω–∏—è",
            workType: "–†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ —Ç—Ä–æ—Ç—É–∞—Ä–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
                  contractNumber: "34/19",
        number: "2.7/18/1",
        date: "31.05.2024",
        pages: 1
      },
      {
        name: "–ê–û–°–† –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ—Å–Ω–æ–≤–∞–Ω–∏–π –ê–ë –ø–æ–∫—Ä—ã—Ç–∏—è",
            workType: "–ó–∞–º–µ–Ω–∞ –¥–æ—Ä–æ–∂–Ω–æ–≥–æ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
                  contractNumber: "50220-1784/11819",
        number: "–±/–Ω",
        date: "31.05.2024",
        pages: 15
      }
    ]
  },
  {
    name: "–î–≤–æ—Ä–æ–≤–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è –ø–æ –∞–¥—Ä–µ—Å—É: –ö–∞—Ä–≥–æ–ø–æ–ª—å—Å–∫–∞—è —É–ª. 18",
    documents: [
      {
        name: "–ü—Ä–∏–∫–∞–∑",
          workType: "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å–∞–¥–æ–≤–æ–≥–æ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
                  contractNumber: "1502-123-2020",
        number: "710",
        date: "29.12.2023",
        pages: 16
      },
      {
        name: "–ü—Ä–∏–∫–∞–∑",
          workType: "–†–µ–º–æ–Ω—Ç –≥–∞–∑–æ–Ω–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
                  contractNumber: "–ò–ì-14460/1783",
        number: "10/04/24-–ê–î",
        date: "10.04.2024",
        pages: 1
      }
    ]
  },
  {
    name: "–î–≤–æ—Ä–æ–≤–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è –ø–æ –∞–¥—Ä–µ—Å—É: –ë–µ—Å—Ç—É–∂–µ–≤—ã—Ö —É–ª. 27–ê",
    documents: [
      {
        name: "–ê–û–°–† –Ω–∞ –î–µ–º–æ–Ω—Ç–∞–∂ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è",
         workType: "–†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∑–¥–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
                  contractNumber: "13464-–û–ú–¢–û-20",
        number: "3.7/18/1",
        date: "31.05.2024",
        pages: 1
      },
      {
        name: "–ê–û–°–† –Ω–∞ –î–µ–º–æ–Ω—Ç–∞–∂ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è",
         workType: "–†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ —Ç—Ä–æ—Ç—É–∞—Ä–∞ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
                  contractNumber: "21000001",
        number: "3.14/18/1",
        date: "31.05.2024",
        pages: 1
      }
    ]
  },
  {
    name: "–î–≤–æ—Ä–æ–≤–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è –ø–æ –∞–¥—Ä–µ—Å—É: –ß–µ–ª–æ–±–∏—Ç—å–µ–≤—Å–∫–æ–µ —à–æ—Å—Å–µ 14 –∫.3, 14 –∫.4, 14 –∫.5",
    documents: [
      {
        name: "–ê–û–°–† –Ω–∞ –°—Ä–µ–∑–∫—É –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω—ã—Ö –ø–æ–∫—Ä—ã—Ç–∏–π –º–µ—Ç–æ–¥–æ–º —Ñ—Ä–µ–∑–µ—Ä–æ–≤–∞–Ω–∏—è",
               workType: "–ó–∞–º–µ–Ω–∞ –æ–≥—Ä–∞–∂–¥–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–∏ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
                  contractNumber: "10/03-10",
        number: "2.14/18/1",
        date: "31.05.2024",
        pages: 1
      },
      {
        name: "–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è",
               workType: "–û–ë–£–°–¢–†–û–ô–°–¢–í–û –ú–ê–§ –¢–ï–†–†–ò–¢–û–†–ò–ô",
                  contractNumber: "510-–û–†–ö–ò–°-21",
        number: "–±/–Ω",
        date: "31.05.2024",
        pages: 15
      }
    ]
  },
  {
    name: "–î–≤–æ—Ä–æ–≤–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è –ø–æ –∞–¥—Ä–µ—Å—É: –ú–∏—Ä–∞ –ø—Ä–æ—Å–ø. 194",
    documents: [
      {
        name: "–ü—Ä–∏–∫–∞–∑",
                   workType: "–†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è –∞—Å—Ñ–∞–ª—å—Ç–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ –∞–≤—Ç–æ–ø–∞—Ä–∫–æ–≤–∫–∏ –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
                  contractNumber: "21000049",
        number: "20240709-01",
        date: "09.07.2024",
        pages: 1
      },
      {
        name: "–ü—Ä–∏–∫–∞–∑",
                   workType: "–ó–∞–º–µ–Ω–∞ –¥–æ—Ä–æ–∂–Ω–æ–≥–æ –±–æ—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–º–Ω—è –≤ —Ä–∞–º–∫–∞—Ö –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏",
                  contractNumber: "2945-–ê–¢–†-21",
        number: "2",
        date: "24.04.2024",
        pages: 1
      }
    ]
  }
];


  // –í–∫–ª–∞–¥–∫–∏
  document.querySelectorAll(".tab-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));
      document.querySelectorAll(".tab-section").forEach(s => s.classList.remove("active"));
      btn.classList.add("active");
      document.getElementById(btn.dataset.tab).classList.add("active");
    });
  });

 const documentsDataFromObjects = objectsWithDocuments.flatMap(obj =>
  obj.documents.map(doc => ({
    name: doc.name,
      workType: doc.workType,
     contractNumber: doc.contractNumber || "",
    docNumber: doc.number,
    uploadDate: doc.date,
    pageCount: doc.pages,
    objectName: obj.name
  }))
);

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫–ª–æ–Ω–µ–Ω–∏—è —Å–ª–æ–≤–∞ "–¥–æ–∫—É–º–µ–Ω—Ç"
function pluralizeDocs(count) {
  if (count % 10 === 1 && count % 100 !== 11) return "–¥–æ–∫—É–º–µ–Ω—Ç";
  if ([2, 3, 4].includes(count % 10) && ![12, 13, 14].includes(count % 100)) return "–¥–æ–∫—É–º–µ–Ω—Ç–∞";
  return "–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤";
}

const documentColumns = [
  { title: "–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ", field: "name", widthGrow: 2 },
  { title: "–í–∏–¥ —Ä–∞–±–æ—Ç", field: "workType" },
   { title: "–ù–æ–º–µ—Ä –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞", field: "contractNumber" },
  { title: "–ù–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞", field: "docNumber" },
  { title: "–î–∞—Ç–∞", field: "uploadDate" },
  { title: "–ö–æ–ª-–≤–æ –ª–∏—Å—Ç–æ–≤", field: "pageCount" }
];

const tableDocuments = new Tabulator("#table-documents", {
  data: documentsDataFromObjects,
  layout: "fitColumns",
  height: 655,
  placeholder: "–ù–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤",
  columns: documentColumns,
  groupBy: "objectName",
  groupStartOpen: false,
  groupToggleElement: "header",
groupHeader: function (value, count) {
  return `<span style="margin-left: 4px; color:#000; font-weight: normal;">
    ${value} (${count} ${pluralizeDocs(count)})
  </span>`;
}

});
// üîç –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
document.getElementById("filter-doc-name").addEventListener("input", e => {
  tableDocuments.setFilter("name", "like", e.target.value);
});

document.getElementById("filter-doc-number").addEventListener("input", e => {
  tableDocuments.setFilter("docNumber", "like", e.target.value);
});

document.getElementById("filter-doc-date").addEventListener("input", e => {
  tableDocuments.setFilter("uploadDate", "like", e.target.value);
});


// üìå –§–∏–ª—å—Ç—Ä—ã –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ "–†–µ–µ—Å—Ç—Ä –æ–±—ä–µ–∫—Ç–æ–≤"
document.getElementById("filter-name").addEventListener("input", function () {
  tableObjects.setFilter("name", "like", this.value);
});
document.getElementById("filter-district").addEventListener("input", function () {
  tableObjects.setFilter("district", "like", this.value);
});
document.getElementById("filter-performer").addEventListener("input", function () {
  tableObjects.setFilter("performer", "like", this.value);
});
document.getElementById("filter-year").addEventListener("input", function () {
  tableObjects.setFilter("year", "like", this.value);
});
document.getElementById("filter-responsible").addEventListener("input", function () {
  tableObjects.setFilter("responsible", "like", this.value);
});
document.getElementById("filter-start").addEventListener("input", function () {
  tableObjects.setFilter("startDate", "like", this.value);
});
document.getElementById("filter-end").addEventListener("input", function () {
  tableObjects.setFilter("endDate", "like", this.value);
});

document.getElementById("filter-doc-contract").addEventListener("input", e => {
  tableDocuments.setFilter("contractNumber", "like", e.target.value);
});





document.getElementById("exportExcelBtn").addEventListener("click", function () {
 




  
  
const wb = XLSX.utils.book_new();

  // === –û–±—ä–µ–∫—Ç—ã —Å –ø–æ–¥—Ä–∞–±–æ—Ç–∞–º–∏ ===
  const rawObjects = tableObjects.getData(true); // ‚úÖ –ø–æ–ª—É—á–∏—Ç—å —Å –¥–µ—Ç—å–º–∏

  const flatObjects = [];

  rawObjects.forEach(obj => {
    // –†–æ–¥–∏—Ç–µ–ª—å
    flatObjects.push({
      "–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ": obj.name,
      "–ì–æ–¥": obj.year,
      "–û–∫—Ä—É–≥": obj.district,
      "–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å": obj.performer,
      "–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π": obj.responsible,
      "–ù–∞—á–∞–ª–æ": obj.startDate,
      "–û–∫–æ–Ω—á–∞–Ω–∏–µ": obj.endDate,
      "% –ó–∞–≤–µ—Ä—à–µ–Ω–∏—è": obj.progress,
      "–¢–∏–ø": "–û–±—ä–µ–∫—Ç"
    });

    // –î–µ—Ç–∏
    if (Array.isArray(obj._children)) {
      obj._children.forEach(child => {
        flatObjects.push({
          "–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ": "‚Ü≥ " + child.name,
          "–ì–æ–¥": "",
          "–û–∫—Ä—É–≥": "",
          "–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å": "",
          "–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π": "",
          "–ù–∞—á–∞–ª–æ": child.startDate,
          "–û–∫–æ–Ω—á–∞–Ω–∏–µ": child.endDate,
          "% –ó–∞–≤–µ—Ä—à–µ–Ω–∏—è": child.progress,
          "–¢–∏–ø": "–†–∞–±–æ—Ç–∞"
        });
      });
    }
  });

  const objectSheet = XLSX.utils.json_to_sheet(flatObjects);
  XLSX.utils.book_append_sheet(wb, objectSheet, "–û–±—ä–µ–∫—Ç—ã");

  // === –î–æ–∫—É–º–µ–Ω—Ç—ã ===
  const flatDocs = documentsDataFromObjects.map(doc => ({
    "–û–±—ä–µ–∫—Ç": doc.objectName,
    "–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞": doc.name,
    "–í–∏–¥ —Ä–∞–±–æ—Ç": doc.workType,
    "–ù–æ–º–µ—Ä –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞": doc.contractNumber || "",
    "–ù–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞": doc.docNumber,
    "–î–∞—Ç–∞": doc.uploadDate,
    "–ö–æ–ª-–≤–æ –ª–∏—Å—Ç–æ–≤": doc.pageCount
  }));

  const documentSheet = XLSX.utils.json_to_sheet(flatDocs);
  XLSX.utils.book_append_sheet(wb, documentSheet, "–î–æ–∫—É–º–µ–Ω—Ç—ã");

  // === –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
  XLSX.writeFile(wb, "–ñ—É—Ä–Ω–∞–ª—ã.xlsx");
});


  
// === –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã (—Å–≤–µ—Ç–ª–∞—è/—Ç—ë–º–Ω–∞—è) ===
const themeToggleBtn = document.getElementById("themeToggle");
const html = document.documentElement;

// –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é —Ç–µ–º—É, –µ—Å–ª–∏ –µ—Å—Ç—å
const savedTheme = localStorage.getItem("theme");
if (savedTheme) {
  html.setAttribute("data-theme", savedTheme);
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞
themeToggleBtn.addEventListener("click", () => {
  const current = html.getAttribute("data-theme");
  const newTheme = current === "dark" ? "light" : "dark";
  html.setAttribute("data-theme", newTheme);
  localStorage.setItem("theme", newTheme); // —Å–æ—Ö—Ä–∞–Ω—è–µ–º
});


  
</script>
</body>
</html>
